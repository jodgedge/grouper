(window.webpackJsonp__wix_thunderbolt_app=window.webpackJsonp__wix_thunderbolt_app||[]).push([[105],{239:function(e,t,n){"use strict";n.r(t),n.d(t,"site",(function(){return p})),n.d(t,"page",(function(){return h}));var o=n(7),i=n(788),r=n(244);n.d(t,"SiteMembersApiSymbol",(function(){return r.b}));var s=n(57),a=n(419),c=n(562),u=n(563),l=n(456);n.d(t,"BIEvents",(function(){return l.a}));var d=n(437);n.d(t,"PrivacyStatus",(function(){return d.c})),n.d(t,"INTERACTIONS",(function(){return d.b})),n.d(t,"AUTH_RESULT_REASON",(function(){return d.a}));var m=n(485);for(var b in m)["default","site","page","SiteMembersApiSymbol","BIEvents","PrivacyStatus","INTERACTIONS","AUTH_RESULT_REASON","memberDetailsFromDTO"].indexOf(b)<0&&function(e){n.d(t,e,(function(){return m[e]}))}(b);var g=n(457);n.d(t,"memberDetailsFromDTO",(function(){return g.b}));var p=function(e){e(r.b,s.a.AppWillMountHandler,s.a.AppDidMountHandler).to(i.a)},h=function(e){e(a.b).to(c.a),e(s.a.PageWillMountHandler).to(u.a),e(s.a.PageWillUnmountHandler).to(Object(o.h)([r.b],(function(e){return{pageWillUnmount:function(t){return e.pageWillUnmount(t)}}})))}},456:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(0),i=function(e){var t=e.sessionManager,n=e.businessLogger,i=e.wixBiSession,s=e.viewMode,a=e.language,c=function(e,n){return{biToken:i.msId,context:e,ts:r(i),viewmode:s,visitor_id:t.getVisitorId(),site_member_id:t.getSiteMemberId(),vsi:i.viewerSessionId,site_settings_lng:a.siteLanguage,browser_lng:a.userLanguage,lng_mismatch:a.siteLanguage!==a.userLanguage,layout:n}};return{loginOrSignUpDialogLoaded:function(e,t){void 0===t&&(t="fullscreen"),n.logger.log(Object(o.a)({src:5,evid:658},c(e,t)),{endpoint:"site-members"})},closingDialog:function(e,t){void 0===t&&(t="fullscreen"),n.logger.log(Object(o.a)({src:5,evid:602,form_type:"default"},c(e,t)),{endpoint:"site-members"})},emailAuthSubmitClicked:function(e,t){n.logger.log(Object(o.a)({src:5,evid:603,form_type:"default"},c(e,t)),{endpoint:"site-members"})},siteMembersFeatureLoaded:function(){n.logger.log(Object(o.a)({src:5,evid:698},c()),{endpoint:"site-members"})},siteMembersSdkFeatureLoaded:function(){n.logger.log(Object(o.a)({src:5,evid:699},c()),{endpoint:"site-members"})}}},r=function(e){var t=e.initialTimestamp||0;return Date.now()-t}},457:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var o=function(e){var t,n,o,i,r,s,a,c,u,l;return{id:e.id,emailVerified:null===(t=e.attributes)||void 0===t?void 0:t.emailVerified,role:e.memberRole,owner:e.owner,loginEmail:e.email,memberName:null!==(i=null!==(n=e.name)&&void 0!==n?n:null===(o=e.attributes)||void 0===o?void 0:o.name)&&void 0!==i?i:"",firstName:null===(r=e.attributes)||void 0===r?void 0:r.firstName,lastName:null===(s=e.attributes)||void 0===s?void 0:s.lastName,imageUrl:null!==(c=null===(a=e.attributes)||void 0===a?void 0:a.imageUrl)&&void 0!==c?c:"",nickname:null===(u=e.attributes)||void 0===u?void 0:u.nickname,profilePrivacyStatus:null===(l=e.attributes)||void 0===l?void 0:l.privacyStatus,slug:e.slug,status:e.status,creationDate:e.dateCreated,lastUpdateDate:e.dateUpdated,emails:[],phones:[],addresses:[],labels:[],groups:[],customFields:[]}},i=function(){return new Promise((function(){return 0}))}},485:function(e,t){},562:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(0),i=n(7),r=n(227),s=n(244),a=Object(i.h)([s.b,r.a],(function(e,t){return{getTpaHandlers:function(){var n=this,i=function(i,r,s){return Object(o.b)(n,void 0,Promise,(function(){var n,i,r,a;return Object(o.d)(this,(function(o){switch(o.label){case 0:return[4,e.getMemberDetails()];case 1:return(n=o.sent())?!(null===(i=s.appClientSpecMapData)||void 0===i?void 0:i.isWixTPA)&&t["specs.thunderbolt.removePiiFromSMTPAs"]?[2,{id:n.id,owner:n.owner,status:n.status}]:[2,{attributes:{firstName:null!==(r=n.firstName)&&void 0!==r?r:"",lastName:null!==(a=n.lastName)&&void 0!==a?a:"",privacyStatus:n.profilePrivacyStatus},name:n.memberName,email:n.loginEmail,id:n.id,owner:n.owner,status:n.status}]:[2,null]}}))}))},r=function(t,i){return void 0===i&&(i={}),Object(o.b)(n,void 0,Promise,(function(){var t,n,r;return Object(o.d)(this,(function(o){switch(o.label){case 0:return[4,e.promptLogin({mode:i.mode,modal:i.modal})];case 1:return t=o.sent().member,[2,{attributes:{firstName:null!==(n=t.firstName)&&void 0!==n?n:"",lastName:null!==(r=t.lastName)&&void 0!==r?r:"",privacyStatus:t.profilePrivacyStatus},name:t.memberName,email:t.loginEmail,id:t.id,owner:t.owner,status:t.status}]}}))}))};return{currentMember:i,smCurrentMember:i,logOutCurrentMember:function(t,n){e.logout(null==n?void 0:n.url)},requestLogin:r,smRequestLogin:r}}}}))},563:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(0),i=n(7),r=n(24),s=n(411),a=n(244),c=Object(i.h)([a.b,Object(i.f)(r.e,a.c),s.b],(function(e,t,n){var i=t.componentIds;return{pageWillMount:function(){return Object(o.b)(this,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(r){return t=i.reduce((function(t,i){var r,s=e.getSocialAuthComponentProps(n.get(i));return Object(o.a)(Object(o.a)({},t),((r={})[i]=s,r))}),{}),n.update(t),[2]}))}))}}}))},788:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var o=n(0),i=n(7),r=n(24),s=n(405),a=n(34),c=n(411),u=n(417),l=n(418),d=n(404),m=n(229),b=n(227),g=n(278),p=n(25),h=n(4),f=n(259),v=n(238),S=n(416),w=n(9),O=n(437),C=n(481),D=n(244),P=function(){function e(e,t,n){this.propsStore=e,this.structureApi=t,this.siteScrollBlocker=n}return e.prototype.displayDialog=function(e,t,n,i){return void 0===i&&(i={}),Object(o.b)(this,void 0,Promise,(function(){var r,s,a,c=this;return Object(o.d)(this,(function(u){switch(u.label){case 0:return r=function(){return Object(o.b)(c,void 0,void 0,(function(){var i,r;return Object(o.d)(this,(function(s){switch(s.label){case 0:return i=Object(w.uniqueId)(D.a),this.propsStore.update(((r={})[i]=Object(o.a)(Object(o.a)({},t),n),r)),Object(C.b)(),[4,this.structureApi.addComponentToDynamicStructure(i,{componentType:e,components:[]})];case 1:return s.sent(),this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId)),this.siteScrollBlocker.setSiteScrollingBlocked(!0,i),this.currentCompId=i,[2]}}))}))},s=i.shouldWaitForAppDidMount,a=i.registerToAppDidMount,s&&a?(a(r),[3,3]):[3,1];case 1:return[4,r()];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))},e.prototype.hideDialog=function(){this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId),Object(C.a)()),this.currentCompId=void 0},e}(),k=n(457),j=n(456),T=function(){function e(e){this.shouldRunCustomPopupCloseCallback=!0,this.popups=e}return e.prototype.openPopupPage=function(e,t,n){var i;return Object(o.b)(this,void 0,void 0,(function(){var r,s=this;return Object(o.d)(this,(function(o){switch(o.label){case 0:return r=this.shouldRunCustomPopupCloseCallback,this.shouldRunCustomPopupCloseCallback=!1,this.assignRequestAuthenticationRejection(t),[4,null===(i=this.popups)||void 0===i?void 0:i.openPopupPage(e,(function(){s.shouldRunCustomPopupCloseCallback&&(s.rejectAuthenticationRequest(),n&&n())}))];case 1:return o.sent(),this.shouldRunCustomPopupCloseCallback=r,[2]}}))}))},e.prototype.preventCustomPopupCloseCallback=function(){this.shouldRunCustomPopupCloseCallback=!1},e.prototype.allowCustomPopupCloseCallback=function(){this.shouldRunCustomPopupCloseCallback=!0},e.prototype.assignRequestAuthenticationRejection=function(e){this.requestAuthenticationRejection=this.requestAuthenticationRejection||e},e.prototype.rejectAuthenticationRequest=function(){this.requestAuthenticationRejection&&(this.requestAuthenticationRejection(O.a.CANCELED),this.requestAuthenticationRejection=void 0)},e}(),y=function(e,t,n){return function(i,r){void 0===r&&(r={});var s=Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)({},t.headers),r.body?{"Content-Type":"application/x-www-form-urlencoded"}:{}),r.headers),{"x-wix-client-artifact-id":"thunderbolt"}),a=Object(o.a)(Object(o.a)({},r),{headers:s}),c=new URL(i,n).href;return e.envFetch(c,Object(o.a)(Object(o.a)({},t),a)).then((function(e){return Object(o.b)(void 0,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(n){switch(n.label){case 0:return[4,e.json()];case 1:if(t=n.sent(),!e.ok)throw t;return[2,t]}}))}))}))}},L=function(e,t,n){document.cookie=e+"=;max-age=0",document.cookie=e+"=;max-age=0;path="+t,document.cookie=e+"=;domain="+n+";max-age=0",document.cookie=e+"=;domain="+n+";max-age=0;path="+t},E=Object(i.h)([Object(i.f)(r.f,D.c),Object(i.f)(r.d,D.c),s.a,a.f,a.p,p.a,c.b,c.d,a.e,a.b,h.e,f.a,u.a,h.i,l.a,d.b,Object(i.g)(v.d),Object(i.g)(S.a),m.a,b.a],(function(e,t,n,i,r,s,a,c,u,l,d,m,b,p,h,f,v,S,C,D){var E,I;void 0===S&&(S={trackEvent:function(){return 0}});var A=e.collectionExposure,R=e.smcollectionId,_=e.svSession,M=e.smSessionCookie,U=e.protectedHomepage,N=e.isCommunityInstalled,x=e.memberInfoAppId,F=e.sm_efCookie,q="WixInternal"===A,W=s.getAppInstanceByAppDefId("22bef345-3c5b-4c18-b782-74d4085112ff"),B=null!==(E=s.getVisitorId())&&void 0!==E?E:"00000000-0000-0000-0000-000000000000",V=t.smSettings,G=t.tpaApplicationIds,H=t.policyLinks,K=x&&G[x],Y=r.site,z=Y.siteRevision,J=Y.metaSiteId,X=Y.siteId,$=Y.externalBaseUrl,Q=r.requestUrl,Z=r.viewMode,ee="/_api/wix-sm-webapp/tokens/verify/"+J+"/"+X,te=$.replace(/\/$/,"")+"/api/wix-sm/v1/authorize/"+X+"/pages",ne="/_api/wix-sm-webapp/tokens/logout/"+J,oe="/_api/wix-sm-webapp/member/changePasswordWithMailToken?metaSiteId="+J+"&collectionId="+R,ie="/_api/wix-sm-webapp/social/token/handle?metaSiteId="+J+"&collectionId="+R,re=$.replace(/\/$/,"")+"/_api/dynamicmodel",se=V.smFirstDialogLogin?"login":"signup",ae=V.socialLoginFacebookEnabled,ce=V.socialLoginGoogleEnabled,ue=V.termsOfUse,le=V.privacyPolicy,de=V.codeOfConduct,me=V.customSignUpPageId,be=V.customSignInPageId,ge=null===(I=V.joinCommunityCheckedByDefault)||void 0===I||I,pe=e.smToken,he={},fe=M,ve=null,Se=!1,we=function(e){ve=e},Oe=function(){var e=!C.getCurrentRouteInfo();return{registerToAppDidMount:we,shouldWaitForAppDidMount:!Se&&e}},Ce={},De={},Pe=Object(j.a)({sessionManager:s,businessLogger:h,wixBiSession:f,viewMode:null==Z?void 0:Z.toUpperCase(),language:u});Pe.siteMembersFeatureLoaded();var ke={},je=y(n,{credentials:"same-origin",headers:{accept:"application/json","x-wix-site-revision":""+z,"x-wix-client-artifact-id":"thunderbolt"}},r.requestUrl),Te=function(e,t,n){return new P(e,t,n)}(a,c,m),ye=D["specs.thunderbolt.sm_googleAuthViaSDK"],Le=new T(v),Ee={appDidMount:function(){ve&&ve(),Se=!0},login:function(e,t,n){return Object(o.b)(this,void 0,Promise,(function(){var i,r,s;return Object(o.d)(this,(function(o){switch(o.label){case 0:S.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:"Wix"}}),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,Ee.performLogin(e,t,n)];case 2:return i=o.sent(),[4,Ee.handleLoginResponse(i)];case 3:return r=o.sent(),S.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:"Wix"}}),[2,r];case 4:throw s=o.sent(),S.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:"Wix"}}),s;case 5:return[2]}}))}))},performLogin:function(e,t,n){var i;return Object(o.b)(this,void 0,Promise,(function(){var r,s,a,c,u,l,d,m,b;return Object(o.d)(this,(function(o){switch(o.label){case 0:return D["specs.thunderbolt.sm_platformizedLogin"]?[4,je("/_api/wix-sm-webapp/v1/auth/login",{method:"POST",headers:{"Content-Type":"application/json",authorization:W||""},body:JSON.stringify({email:e,password:t,recaptchaToken:null==n?void 0:n.recaptchaToken})})]:[3,2];case 1:return[2,{member:(r=o.sent()).member,token:null===(i=null==r?void 0:r.session)||void 0===i?void 0:i.token}];case 2:return s=encodeURIComponent(e),a=encodeURIComponent(t),c="email="+s+"&password="+a+"&collectionId="+R+"&metaSiteId="+J+"&appUrl="+Q+"&svSession="+_,(null==n?void 0:n.recaptchaToken)&&(c=c+"&recaptchaToken="+n.recaptchaToken),[4,je("/_api/wix-sm-webapp/member/login",{method:"POST",body:c})];case 3:if(u=o.sent(),l=u.errorCode,d=u.payload,l)throw l;return m=d.sessionToken,b=d.siteMemberDto,[2,{member:Object(k.b)(b),token:m}]}}))}))},handleOauthToken:function(e,t,n,r){return Object(o.b)(this,void 0,Promise,(function(){var a,c,l,d,m,b,g,p;return Object(o.d)(this,(function(o){switch(o.label){case 0:return a=s.getVisitorId(),i.interactionStarted(O.b.SOCIAL_APP_LOGIN),S.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:t}}),[4,je(ie,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svSession:_,visitorId:a,token:e,provider:t,mode:n,lang:u.userLanguage,privacyStatus:r})})];case 1:if(c=o.sent(),l=c.errorCode,d=c.payload,l)throw S.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:t}}),l;return i.interactionEnded(O.b.SOCIAL_APP_LOGIN),d.smSession&&(b=d.smSession.siteMemberDto,m=d.smSession.sessionToken),b=d.siteMemberDto,g=Object(k.b)(b),[4,Ee.handleLoginResponse({member:g,token:m})];case 2:return p=o.sent(),S.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:t}}),[2,p]}}))}))},handleSocialLoginResponse:function(e,t){return Object(o.b)(this,void 0,Promise,(function(){var n,r,s,a;return Object(o.d)(this,(function(o){switch(o.label){case 0:return i.interactionStarted(O.b.SOCIAL_APP_LOGIN),i.interactionEnded(O.b.SOCIAL_APP_LOGIN),S.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:t}}),e.smSession&&(r=e.smSession.siteMemberDto,n=e.smSession.sessionToken),r=e.siteMemberDto,s=Object(k.b)(r),[4,Ee.handleLoginResponse({member:s,token:n})];case 1:return a=o.sent(),S.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:t}}),[2,a]}}))}))},handleLoginResponse:function(e){var t=e.token,n=e.member;return Object(o.b)(this,void 0,Promise,(function(){var e,i;return Object(o.d)(this,(function(o){switch(o.label){case 0:return e=n.emailVerified,t||e||"ACTIVE"!==n.status?[3,2]:[4,Ee.showConfirmationEmailDialog(n.id)];case 1:return o.sent(),[2,Object(k.a)()];case 2:return t?[3,5]:[4,b()];case 3:return i=o.sent(),[4,Ee.showNotificationDialog("",(i("siteMembersTranslations","SMApply_Success1","Success! Your member signup request has been sent and is awaiting approval.")+" "+i("siteMembersTranslations","SMApply_Success2","The site administrator will notify you via email ({0}) once your request has been approved.")).replace("{0}",n.loginEmail),i("siteMembersTranslations","SMContainer_OK","OK"))];case 4:return o.sent(),[2,Object(k.a)()];case 5:return[4,Ee.applySessionToken(t,n)];case 6:return o.sent(),[2,{sessionToken:t,member:n}]}}))}))},promptLogin:function(e,t){void 0===e&&(e={}),void 0===t&&(t=!0);var n=e.mode,o=e.modal,i=null!=n?n:se,r=o&&D["specs.thunderbolt.sm_displayLoginAsAPopup"]?"popup":"fullscreen";return"login"===i?Ee.showLoginDialog(t,r):Ee.showSignUpDialog(t,r)},promptForgotPassword:function(e){return void 0===e&&(e=!0),new Promise((function(t,n){Le.assignRequestAuthenticationRejection(n);var i={isCloseable:e},r={onCloseDialogCallback:function(){Pe.closingDialog("RequestResetPassword"),Te.hideDialog(),Le.rejectAuthenticationRequest()},onSubmitCallback:function(e){var n=this;return Ee.sendForgotPasswordMail(e).then((function(){return Object(o.b)(n,void 0,void 0,(function(){var e;return Object(o.d)(this,(function(n){switch(n.label){case 0:return[4,b()];case 1:return e=n.sent(),Ee.showNotificationDialog(e("siteMembersTranslations","siteMembersTranslations_RESET_PASSWORD_CHECKEMAIL_TITLE","Please Check Your Email"),e("siteMembersTranslations","siteMembersTranslations_RESET_PASSWORD_CHECKEMAIL_TEXT","We\u2019ve emailed you a link to reset your password."),e("siteMembersTranslations","siteMembersTranslations_Reset_Password_OK","Got It")),t(),[2]}}))}))}))}};Te.displayDialog("RequestPasswordResetDialog",i,r)}))},requestAuthentication:function(e){return void 0===e&&(e={}),Object(o.b)(this,void 0,Promise,(function(){var t;return Object(o.d)(this,(function(n){switch(n.label){case 0:if(fe)return[2,{success:!0,token:fe,reason:O.a.ALREADY_LOGGED_IN}];n.label=1;case 1:return n.trys.push([1,3,,4]),t=!U,[4,Ee.promptLogin(e,t)];case 2:return[2,{success:!0,token:n.sent().sessionToken,reason:O.a.SUCCESS}];case 3:return[2,{success:!1,reason:n.sent()}];case 4:return[2]}}))}))},applySessionToken:function(e,t){return Object(o.b)(this,void 0,Promise,(function(){var n,r;return Object(o.d)(this,(function(a){switch(a.label){case 0:return i.interactionStarted(O.b.VERIFY_TOKEN),[4,je(ee,{method:"POST",body:"token="+e})];case 1:if(n=a.sent().errorCode)throw n;return i.interactionEnded(O.b.VERIFY_TOKEN),[4,s.loadNewSession({reason:"memberLogin"})];case 2:return a.sent(),[4,Ee.getSmToken()];case 3:return pe=a.sent(),fe=e,null==t?[3,4]:(r=t,[3,6]);case 4:return[4,Ee.getMemberDetails()];case 5:r=a.sent(),a.label=6;case 6:return he=r,[4,Promise.all(Object.values(Ce).map((function(e){return Object(o.b)(void 0,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),i.captureError(t,{tags:{feature:"site-members"}}),[3,3];case 3:return[2]}}))}))})))];case 7:return a.sent(),[2]}}))}))},getSmToken:function(){return Object(o.b)(this,void 0,Promise,(function(){var e;return Object(o.d)(this,(function(t){switch(t.label){case 0:return[4,n.envFetch(re).then((function(e){return e.json()}))];case 1:return e=t.sent().clientSpecMap,[2,Object.values(e).find((function(e){return"sitemembers"===e.type})).smtoken]}}))}))},authorizeMemberPagesByCookie:function(){return Object(o.b)(this,void 0,Promise,(function(){var e,t,n,i;return Object(o.d)(this,(function(o){switch(o.label){case 0:return e=Object(g.e)(l)?{headers:{cookie:"smSession="+M}}:void 0,[4,je(te,e)];case 1:if(t=o.sent(),n=t.authorizedPages,i=t.errorCode)throw i;return[2,n]}}))}))},authorizeMemberPagesByToken:function(e){return Object(o.b)(this,void 0,Promise,(function(){var t,n,i;return Object(o.d)(this,(function(o){switch(o.label){case 0:return e===M?[2,this.authorizeMemberPagesByCookie()]:[4,je(ee,{method:"POST",body:"token="+e})];case 1:if(t=o.sent(),n=t.payload,i=t.errorCode)throw i;return[2,n.pages]}}))}))},getMemberDetails:function(e){return void 0===e&&(e=!1),Object(o.b)(this,void 0,Promise,(function(){var t,n,r;return Object(o.d)(this,(function(s){switch(s.label){case 0:return!he.id||e?[3,1]:[2,he];case 1:return pe?[4,je("/_api/wix-sm-webapp/member/"+pe+"?collectionId="+R+"&metaSiteId="+J)]:[3,5];case 2:if(t=s.sent(),n=t.payload,r=t.errorCode)throw r;return he=Object(k.b)(n),e?[4,Promise.all(Object.values(ke).map((function(e){return Object(o.b)(void 0,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),i.captureError(t,{tags:{feature:"site-members"}}),[3,3];case 3:return[2]}}))}))})))]:[3,4];case 3:s.sent(),s.label=4;case 4:return[2,he];case 5:return[2,null]}}))}))},register:function(e,t,n,r,s){return Object(o.b)(this,void 0,void 0,(function(){var a,c,u,l,d,m,g,p,h,f;return Object(o.d)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,9,,10]),i.interactionStarted(O.b.CODE_SIGNUP),S.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Submit",eventLabel:"Wix"}}),a={email:e,password:t,profilePrivacyStatus:r,contactInfo:n,defaultFlow:s},[4,je("/_api/wix-sm-webapp/v1/auth/signup",{method:"POST",headers:{"Content-Type":"application/json",authorization:W||""},body:JSON.stringify(a)})];case 1:return c=o.sent(),u=c.member,l=c.approvalToken,d=c.session,m=u.emailVerified,g=null==d?void 0:d.token,p="ACTIVE"===(null==u?void 0:u.status)?"ACTIVE":"PENDING",g||m||"ACTIVE"!==u.status?[3,3]:[4,Ee.showConfirmationEmailDialog(u.id)];case 2:return o.sent(),i.interactionEnded(O.b.CODE_SIGNUP),[2,{member:u,status:p}];case 3:return s&&"APPLICANT"===(null==u?void 0:u.status)||!g?[4,b()]:[3,6];case 4:return h=o.sent(),[4,Ee.showNotificationDialog("",(h("siteMembersTranslations","SMApply_Success1","Success! Your member login request has been sent and is awaiting approval.")+" "+h("siteMembersTranslations","SMApply_Success2","The site administrator will notify you via email ({0}) once your request has been approved.")).replace("{0}",e),h("siteMembersTranslations","SMContainer_OK","OK"))];case 5:return o.sent(),i.interactionEnded(O.b.CODE_SIGNUP),[2,{member:u,status:p,approvalToken:l}];case 6:return[4,Ee.applySessionToken(g,u)];case 7:return o.sent(),i.interactionEnded(O.b.CODE_SIGNUP),S.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Success",eventLabel:"Wix"}}),[2,{member:u,status:p,sessionToken:g}];case 8:return[3,10];case 9:throw f=o.sent(),S.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Failure",eventLabel:"Wix"}}),f;case 10:return[2]}}))}))},sendForgotPasswordMail:function(e){return Object(o.b)(this,void 0,void 0,(function(){var t,n,r,s;return Object(o.d)(this,(function(o){switch(o.label){case 0:return i.interactionStarted(O.b.RESET_PASSWORD),t=u.userLanguage,n=encodeURIComponent(Q),r=encodeURIComponent(e),[4,je("/_api/wix-sm-webapp/member/sendForgotPasswordMail",{method:"POST",body:"returnUrl="+n+"&collectionId="+R+"&metaSiteId="+J+"&lang="+t+"&email="+r})];case 1:if(s=o.sent().errorCode)throw s;return i.interactionEnded(O.b.RESET_PASSWORD),[2]}}))}))},changePassword:function(e,t){return Object(o.b)(this,void 0,void 0,(function(){var n,i;return Object(o.d)(this,(function(o){switch(o.label){case 0:return n=encodeURIComponent(e),[4,je(oe,{method:"POST",body:"newPassword="+n+"&forgotPasswordToken="+t})];case 1:if(i=o.sent().errorCode)throw i;return[2]}}))}))},resendEmailVerification:function(e){return Object(o.b)(this,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(n){switch(n.label){case 0:return[4,je("/_api/wix-sm-webapp/tokens/email/resend/"+e)];case 1:if(t=n.sent().errorCode)throw t;return[2]}}))}))},logout:function(e){return Object(o.b)(this,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(n){switch(n.label){case 0:return pe?[4,je(ne,{method:"POST"})]:[2];case 1:return n.sent(),[4,Promise.all(Object.values(De).map((function(e){return Object(o.b)(void 0,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),i.captureError(t,{tags:{feature:"site-members"}}),[3,3];case 3:return[2]}}))}))})))];case 2:return n.sent(),e?(t="./"+e.replace(/^\//,""),[4,d.navigate(t)]):[3,4];case 3:n.sent(),n.label=4;case 4:return Object(g.e)(l)||l.document.location.reload(),[2]}}))}))},registerToUserLogin:function(e){var t=Object(w.uniqueId)("callback");return Ce[t]=e,t},unRegisterToUserLogin:function(e){delete Ce[e]},registerToMemberLogout:function(e){var t=Object(w.uniqueId)("logout_callback");return De[t]=e,t},unRegisterToMemberLogout:function(e){delete De[e]},registerToMemberDetailsRefresh:function(e){var t=Object(w.uniqueId)("mdrcb");return ke[t]=e,t},unRegisterToMemberDetailsRefresh:function(e){delete ke[e]},showWelcomeDialog:function(e){return void 0===e&&(e=!0),Object(o.b)(this,void 0,void 0,(function(){var t,n;return Object(o.d)(this,(function(o){return t={isCloseable:e},n={onCloseDialogCallback:function(){Pe.closingDialog("WelcomeDialog");var e=new URL(r.requestUrl).hostname,t=0===e.indexOf("www")?e.substr(3):e;L("sm_ef","/",t),F="",Te.hideDialog()},onSubmitCallback:function(){var e=new URL(r.requestUrl).hostname,t=0===e.indexOf("www")?e.substr(3):e;L("sm_ef","/",t),F="",Te.hideDialog(),K&&d.navigate("./account/my-account")}},Te.displayDialog("WelcomeDialog",t,n),[2]}))}))},showNoPermissionsToPageDialog:function(e){return Object(o.b)(this,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(n){return t={onCloseDialogCallback:function(){Te.hideDialog(),e&&e()},onSwitchAccountLinkClick:function(){Ee.logout()}},Te.displayDialog("NoPermissionsToPageDialog",{},t),[2]}))}))},showResetPasswordDialog:function(e){return Object(o.b)(this,void 0,void 0,(function(){var t,n;return Object(o.d)(this,(function(i){return t={isCloseable:!0},n={onCloseDialogCallback:function(){Pe.closingDialog("ResetPasswordDialog");var e=p.getParsedUrl();e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),p.pushUrlState(e),Te.hideDialog()},onSubmitCallback:function(n){return Object(o.b)(this,void 0,void 0,(function(){var i;return Object(o.d)(this,(function(o){switch(o.label){case 0:return[4,b()];case 1:return i=o.sent(),[2,Ee.changePassword(n,e).then((function(){Ee.showNotificationDialog(i("siteMembersTranslations","siteMembersTranslations_Reset_Password_Sucess_Title","Your password has been changed."),"",i("siteMembersTranslations","SMContainer_OK","OK"),(function(){Ee.showLoginDialog();var e=p.getParsedUrl();e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),p.pushUrlState(e)}))})).catch((function(e){var n=r.experiments["specs.thunderbolt.sm_redirectToResetPasswordLinkOnTokenExpired"];if(-19972!==e||!n)throw e;Ee.showNotificationDialog(i("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_TITLE","Your link to create a new password has expired"),i("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_TEXT","To continue, resend a new link to your email."),i("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_OK","Resend Link"),(function(){return Ee.promptForgotPassword(t.isCloseable)}))}))]}}))}))}},Te.displayDialog("ResetPasswordDialog",t,n),[2]}))}))},showLoginDialog:function(e,t){return void 0===e&&(e=!0),void 0===t&&(t="fullscreen"),Object(o.b)(this,void 0,Promise,(function(){var n=this;return Object(o.d)(this,(function(r){return be&&(null==v?void 0:v.isPopupPage(be))?[2,Ee.showCustomAuthenticationDialog(be)]:[2,new Promise((function(r,s){return Object(o.b)(n,void 0,void 0,(function(){var n,a;return Object(o.d)(this,(function(o){switch(o.label){case 0:return Le.assignRequestAuthenticationRejection(s),n={displayMode:t,language:u.userLanguage,isCloseable:e,smCollectionId:R,svSession:_,biVisitorId:B,metaSiteId:J,isSocialLoginGoogleEnabled:ce,isSocialLoginFacebookEnabled:!q&&ae,isEmailLoginEnabled:!q,useGoogleSdk:ye,shouldRenderACaptcha:!!D["specs.thunderbolt.ShouldVerifyCaptcha"]},a={onCloseDialogCallback:function(){Te.hideDialog(),Pe.closingDialog("MemberLoginDialog",t),Le.rejectAuthenticationRequest()},submit:function(e,n,o){return i.interactionStarted(O.b.DEFAULT_LOGIN),Pe.emailAuthSubmitClicked("MemberLoginDialog",t),Ee.login(e,n,o).then((function(e){i.interactionEnded(O.b.DEFAULT_LOGIN),Te.hideDialog(),r(e)}))},onForgetYourPasswordClick:function(){Ee.promptForgotPassword(e)},onSwitchDialogLinkClick:function(){Ee.showSignUpDialog(e,t).then(r,(function(){Le.rejectAuthenticationRequest()}))},onTokenMessage:function(e,t,n){void 0===n&&(n=!1);var o=n?"PUBLIC":"PRIVATE";return Ee.handleOauthToken(e,t,"memberLoginDialog",o).then((function(e){Te.hideDialog(),r(e)}))},onBackendSocialLogin:function(e,t){return Ee.handleSocialLoginResponse(e,t).then((function(e){Te.hideDialog(),r(e)}))},getHostReadyPayload:function(){return{visitorId:B,svSession:_}}},Pe.loginOrSignUpDialogLoaded("MemberLoginDialog",t),[4,Te.displayDialog("MemberLoginDialog",n,a,Oe())];case 1:return o.sent(),Ee.closeCustomAuthenticationDialogs(!0),[2]}}))}))}))]}))}))},showSignUpDialog:function(e,t){return void 0===e&&(e=!0),void 0===t&&(t="fullscreen"),Object(o.b)(this,void 0,Promise,(function(){var n=this;return Object(o.d)(this,(function(r){return me&&(null==v?void 0:v.isPopupPage(me))?[2,Ee.showCustomAuthenticationDialog(me)]:[2,new Promise((function(r,s){return Object(o.b)(n,void 0,void 0,(function(){var n,a;return Object(o.d)(this,(function(o){switch(o.label){case 0:return Le.assignRequestAuthenticationRejection(s),n={displayMode:t,language:u.userLanguage,isCloseable:e,smCollectionId:R,biVisitorId:B,svSession:_,metaSiteId:J,isSocialLoginGoogleEnabled:ce,isSocialLoginFacebookEnabled:!q&&ae,isEmailLoginEnabled:!q,isCommunityInstalled:N,joinCommunityCheckedByDefault:ge,isTermsOfUseNeeded:!(!(null==ue?void 0:ue.enabled)||!H.termsOfUse),isPrivacyPolicyNeeded:!(!(null==le?void 0:le.enabled)||!H.privacyPolicy),isCodeOfConductNeeded:!(!(null==de?void 0:de.enabled)||!H.codeOfConduct),termsOfUseLink:H.termsOfUse,privacyPolicyLink:H.privacyPolicy,codeOfConductLink:H.codeOfConduct,useGoogleSdk:ye},a={onCloseDialogCallback:function(){Te.hideDialog(),Pe.closingDialog("SignUpDialog",t),Le.rejectAuthenticationRequest()},submit:function(e,n,o){var s="boolean"==typeof o?o:o.isCommunityChecked;i.interactionStarted(O.b.DEFAULT_SIGNUP),Pe.emailAuthSubmitClicked("SignUpDialog",t);var a=s?O.c.PUBLIC:O.c.PRIVATE;return Ee.register(e,n,void 0,a).then((function(e){i.interactionEnded(O.b.DEFAULT_SIGNUP);var t=e.member,n=e.sessionToken;n&&(Te.hideDialog(),r({member:t,sessionToken:n}))}))},onSwitchDialogLinkClick:function(){Ee.showLoginDialog(e,t).then(r,(function(){Le.rejectAuthenticationRequest()}))},onTokenMessage:function(e,t,n){void 0===n&&(n=!1);var o=n?"PUBLIC":"PRIVATE";return Ee.handleOauthToken(e,t,"memberLoginDialog",o).then((function(e){Te.hideDialog(),r(e)}))},onBackendSocialLogin:function(e,t){return Ee.handleSocialLoginResponse(e,t).then((function(e){Te.hideDialog(),r(e)}))},getHostReadyPayload:function(){return{visitorId:B,svSession:_}}},Pe.loginOrSignUpDialogLoaded("SignUpDialog",t),[4,Te.displayDialog("SignUpDialog",n,a,Oe())];case 1:return o.sent(),Ee.closeCustomAuthenticationDialogs(!0),[2]}}))}))}))]}))}))},showNotificationDialog:function(e,t,n,i,r){return void 0===i&&(i=function(){return 0}),void 0===r&&(r=function(){return 0}),Object(o.b)(this,void 0,void 0,(function(){var s,a;return Object(o.d)(this,(function(o){switch(o.label){case 0:return s={isCloseable:!0,title:e,description:t,okButtonText:n},a={onCloseDialogCallback:function(){Pe.closingDialog("NotificationDialog"),Te.hideDialog(),r()},onOkButtonClick:function(){Te.hideDialog(),i()}},[4,Te.displayDialog("NotificationDialog",s,a)];case 1:return o.sent(),[2]}}))}))},showConfirmationEmailDialog:function(e,t){return void 0===t&&(t=!0),Object(o.b)(this,void 0,void 0,(function(){var n,i;return Object(o.d)(this,(function(r){switch(r.label){case 0:return n={isCloseable:!0,isSignUp:t},i={onCloseDialogCallback:function(){Pe.closingDialog("ConfirmationEmailDialog"),Te.hideDialog()},onResendConfirmationEmail:function(){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.d)(this,(function(t){switch(t.label){case 0:return[4,Ee.resendEmailVerification(e)];case 1:return t.sent(),[4,Ee.showConfirmationEmailDialog(e,!1)];case 2:return t.sent(),[2]}}))}))}},[4,Te.displayDialog("ConfirmationEmailDialog",n,i)];case 1:return r.sent(),[2]}}))}))},showCustomAuthenticationDialog:function(e){return Object(o.b)(this,void 0,Promise,(function(){var t=this;return Object(o.d)(this,(function(n){if(!v)throw new Error("popup unavailable");return[2,new Promise((function(n,i){return Object(o.b)(t,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(o){switch(o.label){case 0:return t=Ee.registerToUserLogin((function(){n({member:he,sessionToken:fe}),Ee.unRegisterToUserLogin(t),v.getCurrentPopupId()===e&&v.closePopupPage()})),[4,Le.openPopupPage(e,i,(function(){Ee.unRegisterToUserLogin(t)}))];case 1:return o.sent(),Te.hideDialog(),[2]}}))}))}))]}))}))},closeCustomAuthenticationDialogs:function(e){return void 0===e&&(e=!1),Object(o.b)(this,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(n){switch(n.label){case 0:return(t=null==v?void 0:v.getCurrentPopupId())&&[me,be].includes(t)?(e&&Le.preventCustomPopupCloseCallback(),[4,v.closePopupPage()]):[3,2];case 1:n.sent(),Le.allowCustomPopupCloseCallback(),n.label=2;case 2:return[2]}}))}))},getForgotPasswordToken:function(){return new URL(Object(g.e)(l)?r.requestUrl:location.href).searchParams.get("forgotPasswordToken")},shouldDisplayWelcomeDialog:function(){return F&&K},willDisplayDialogOnAppWillMount:function(){return!(!Ee.getForgotPasswordToken()&&!Ee.shouldDisplayWelcomeDialog())},appWillMount:function(){var e=Ee.getForgotPasswordToken();if(e)Ee.showResetPasswordDialog(e);else if(Ee.shouldDisplayWelcomeDialog())Ee.showWelcomeDialog();else{switch(new URL(r.requestUrl).searchParams.get("showDialog")){case"MemberLoginDialog":Ee.showLoginDialog();break;case"SignUpDialog":Ee.showSignUpDialog();break;case"RequestPasswordResetDialog":Ee.promptForgotPassword();break;case"ResetPasswordDialog":Ee.showResetPasswordDialog("faketoken");break;case"WelcomeDialog":Ee.showWelcomeDialog();break;case"NoPermissionsToPageDialog":Ee.showNoPermissionsToPageDialog();break;case"NotificationDialog":Ee.showNotificationDialog("title","description","ok");break;case"ConfirmationEmailDialog":Ee.showConfirmationEmailDialog("fakemember")}}},pageWillUnmount:function(e){var t=e.pageId;[me,be].includes(t)||Te.hideDialog()},getSocialAuthComponentProps:function(e){return{biVisitorId:"00000000-0000-0000-0000-000000000000",svSession:_,smCollectionId:R,metaSiteId:J,onTokenMessage:function(e,t,n){void 0===n&&(n=!1);var o=n?"PUBLIC":"PRIVATE";return Ee.handleOauthToken(e,t,"socialAuthComponent",o)},onBackendSocialLogin:Ee.handleSocialLoginResponse,getHostReadyPayload:function(){return{visitorId:B,svSession:_}}}}};return Ee}))}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/siteMembers.fd7c3ec4.chunk.min.js.map